/*
SELECT 
     A.PUR_NBR AS PURCHASE_NO,
     A.VNDR_NBR AS VEN_NO,
     DECODE (B.VNDR_TYP_CD, 'D', A.VNDR_NBR || '-' || B.VNDR_CHN_NM, A.VNDR_NBR || '-' || B.VNDR_ENG_NM) AS VENDOR_NO, 
     DECODE (A.PUR_TYP_IND,  'F', 'F-國外',  'D', 'D-國內') AS PURCHASE_TYPE, 
     A.PUR_TYP_IND AS VENDOR_TYPE,
     A.CURCY_TYP_CD AS CURRENCY_TYPE,
     A.PUR_DT AS PURCHASE_DATE,
     A.RECV_STORE_NBR AS RECEIVE_STORE,
     (A.PAYMT_TERM_CD) AS PAY_TERM,
     A.PUR_EMP_ID AS USER_ID,
     A.RCV_ST_CD AS PURCHASE_STATUS,
     A.PUR_REMARK_TXT AS PURCHASE_REMARK,
     A.UPD_EMP_ID AS UPD_ID,
     A.UPD_DT AS UPD_DATE,
     A.UPD_TM AS UPD_TIME,
     A.PROC_STUS_CD AS STATUS,
     A.RETURN_CONFIRM_FLAG AS RETURN_CONFIRM_FLAG
FROM 
    PUR_PURCHASE_MASTER A,
    VND_VENDOR B,
    BAS_PAYMENT_TERM D
WHERE     
    A.PUR_NBR = :PURCHASE_NO
    AND (A.VNDR_NBR = B.VNDR_NBR(+))
    AND A.PAYMT_TERM_CD = D.PAYMT_TERM_CD
    AND A.PROC_STUS_CD <> '0'
UNION
*/
SELECT 
    A.PUR_NBR,
    A.VNDR_NBR VEN_NO,
    DECODE (B.VNDR_TYP_CD, 'D', A.VNDR_NBR || '-' || B.VNDR_CHN_NM, A.VNDR_NBR || '-' || B.VNDR_ENG_NM) VNDR_NBR, 
    DECODE (A.PUR_TYP_IND,  'F', 'F-國外',  'D', 'D-國內') PUR_TYP_IND,
    A.PUR_TYP_IND VNDR_TYP_CD,
    A.CURCY_TYP_CD,
    A.PUR_DT,
    A.RECV_STORE_NBR,
    A.X,
    (A.PAYMT_TERM_CD || '-' || D.DESCRIPTION) PAYMT_TERM_CD,
    A.PUR_EMP_ID,
    A.RCV_ST_CD,
    A.X,
    A.X,
    A.PUR_REMARK_TXT,
    A.X,
    A.UPD_EMP_ID,
    A.UPD_DT,
    A.UPD_TM,
    A.PROC_STUS_CD,
    A.X,
    A.X,
    A.X,
    A.X,
    A.X,
    A.RETURN_CONFIRM_FLAG,
    A.X
FROM 
    PUR_PURCHASE_MASTER A,
    VND_VENDOR B,
    BAS_PAYMENT_TERM D
WHERE     
    A.PUR_NBR = :PURCHASE_NO
    AND (A.VNDR_NBR = B.VNDR_NBR(+))
    AND A.PAYMT_TERM_CD = D.PAYMT_TERM_CD
    AND A.PROC_STUS_CD <> '0'
